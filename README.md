# 🚀 自動株式バックテストシステム

## 📋 概要

このシステムは、複数のトレーディング戦略を使用した自動株式バックテストシステムです。日足・週足データを使用したスイングトレードと中長期投資戦略を実装しています。

**注意**: デイトレード戦略は除去されました。理由は以下の通りです：
- 5分足データの取得制限により、Yahoo Finance APIから十分なデータを取得できない
- 5分足は過去30日分のみの制限があり、長期バックテストに不適切
- レート制限（HTTP 429）により、高頻度データ取得が困難

## 🎯 実装済みトレーディング戦略

### 1. スイングトレード（数日〜数週間）

#### 買い条件
- 日足で短期移動平均線（5日）＞中期移動平均線（25日）のゴールデンクロス
- RSI（日足）が40〜50付近で反発
- 出来高が20日平均の1.5倍以上
- 株価が直近高値を更新する兆しがある場合は優先

#### 利確条件
- 株価がボリンジャーバンド +2σ に到達
- RSIが70以上で反転兆候が出た場合
- 目標値幅: +5〜10%
- 部分利確を活用（例: +5%で半分売却、残りは+10%まで保持）

#### 損切り条件
- エントリー価格から-5%下落した場合
- 株価が25日移動平均線を明確に割り込んだ場合

#### ポジション管理
- 1回の取引リスク: 資金の1.5%
- 1銘柄あたりの資金配分: 最大25%
- 同時保有銘柄数: 5銘柄

### 2. 中長期投資（数か月〜数年）

#### 買い条件
- 週足で長期移動平均線（200日線）を上回っている
- 好業績（EPS増加率・売上成長）や高ROE
- 出来高を伴って新高値更新
- マクロ環境・景気サイクルも追い風

#### 利確条件
- 株価がファンダメンタルズから乖離しすぎたと判断
- 長期トレンドのピーク（200日線を大きく乖離して+30%以上）
- 相場全体の転換点を確認したとき

#### 損切り条件
- 購入時から-8.5%下落
- 長期移動平均（200日線）を明確に割り込む

#### ポジション管理
- 1回の取引リスク: 資金の1.5%
- 1銘柄あたりの資金配分: 最大15%
- 同時保有銘柄数: 10銘柄
- 分散投資（業種・地域・資産クラスを分ける）

---

## 🛠️ 主な機能

### 1. バックテストエンジン
- 複数のトレーディング戦略に対応
- リスク管理機能（ポジションサイズ計算、損切り）
- 部分利確機能（スイングトレード）
- リアルタイムエクイティカーブ計算

### 2. データ管理
- **stooq.com** による株価データ取得
- データキャッシュ機能
- データ検証・クリーニング機能

### 3. 技術指標計算
- 移動平均線（SMA 5, 25, 200）
- RSI（相対力指数）
- MACD（移動平均収束拡散）
- ストキャスティクス
- ボリンジャーバンド
- VWAP（出来高加重平均価格）
- 出来高指標

### 4. レポート生成
- インタラクティブHTMLレポート
- パフォーマンス指標（シャープレシオ、最大ドローダウン等）
- チャート・グラフ表示
- 取引履歴詳細
- **動的ダッシュボード**: 最新レポートの自動表示
- **履歴管理**: 過去30日間のレポート履歴

---

## 🚀 クイックスタート

### 1. 環境セットアップ

```bash
# 依存関係のインストール
pip install -r requirements.txt

# プロジェクトの実行
python main.py
```

### 2. 基本的な使用方法

```bash
# 全戦略のバックテスト実行
python main.py

# 特定の戦略のみ実行
python main.py --strategy swing_trading

# 特定の期間で実行
python main.py --start-date 2023-01-01 --end-date 2023-12-31

# 特定の銘柄で実行
python main.py --symbols 7203.T 6758.T 9984.T

# index.htmlの手動更新
python update_index.py
```

---

## 📊 データソース

### stooq.com（唯一のデータソース）
- **利点**: 安定したデータ取得、レート制限なし
- **対応銘柄**: 米国株、日本株
- **時間足**: 日足、週足、月足
- **データ期間**: 長期データ（2020年〜現在）

---

## 📈 パフォーマンス指標

- **総リターン**: 期間中の総収益率
- **年率リターン**: 年率換算収益率
- **シャープレシオ**: リスク調整後収益率
- **最大ドローダウン**: 最大下落幅
- **勝率**: 利益取引の割合
- **プロフィットファクター**: 利益/損失比率

---

## 🔧 設定

### config.py
- バックテスト期間設定
- 初期資金設定
- トレーディングルール設定
- 技術指標パラメータ設定

### 環境変数
- `DETAILED_MODE`: 詳細検証モード（true/false）

---

## 📝 注意事項

1. **データの信頼性**: バックテスト結果は過去のデータに基づくものであり、将来の収益を保証するものではありません
2. **リスク管理**: 実際の取引では適切なリスク管理を行ってください
3. **手数料**: バックテストでは手数料を考慮していません
4. **スリッページ**: 実際の取引では価格スリッページが発生する可能性があります

---

## 🤝 貢献

プルリクエストやイシューの報告を歓迎します。  
